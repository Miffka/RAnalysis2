legend.title = element_text(size = 16),
strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL, limits = NA)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL, limits = c(min(Count), max(Count)))+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL))+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(allinfo03, aes(x = "", fill = Phenotype.New))+
geom_histogram(width = 1, position = "fill", stat = "count")+
facet_wrap(~ Phylum, nrow = 1)+
coord_polar(theta = "y")+
scale_x_discrete(name = "", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "", breaks = NULL)+
scale_fill_brewer(type = "qual", palette = 3, name = "Phenotype: ")+
theme(strip.background = element_rect(fill = "blue"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0.1, units = "cm"),
axis.title = element_text(size = 18, vjust = 1),
legend.position = "bottom",
legend.title = element_text(size = 16, vjust = 0),
legend.text = element_text(size = 12),
strip.text.x = element_text(size = 14, colour = "white", face = "bold"))
mosaicplot(table05,
color = T,
shade = T,
main = "",
cex.axis = 0.8,
#off = 1,
type = "pearson")
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "stack", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(group = Var2, x = Var2, y = Count, fill = Freq2))+
geom_col(position = "dodge", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "dodge", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(~ Var1, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "stack", width = 1)+
facet_grid(~ Var1, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_bar(position = "stack", width = 1)+
facet_grid(~ Var1, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "stack", width = 1)+
facet_grid(~ Var1, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "stack", width = 1)+
facet_grid(Var2 ~ Var1, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "stack", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL)+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
#strip.text = element_text(color = "white"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5, size = 14, face = "italic"),
strip.text.x = element_text(size = 14))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
strip.text = element_text(color = "white", size = 14, face = "italic"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
strip.text = element_text(size = 14, face = "italic"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
legend.text = element_text(size = 12),
strip.text = element_text(size = 14, face = "italic"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5))
ggplot(chisqres_dt05, aes(x = Var2, y = Count, fill = Freq2))+
geom_col(position = "fill", width = 1)+
facet_grid(Var1 ~ Var2, switch = "y", scales = "free_x", space = "free")+
scale_x_discrete(name = "Phenotype", labels = c("", "", "", ""), breaks = NULL, position = "top")+
scale_y_continuous(name = "Phylum", breaks = NULL)+
scale_fill_brewer(type = "div",
palette = 7,
name = "Pearson's\nresiduals",
labels = c("<-4", "-4:-2", "-2:0", "0:2", "2:4", ">4"))+
theme(strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.spacing = unit(x = 0.05, units = "cm"),
axis.title = element_text(size = 18),
legend.title = element_text(size = 16),
legend.text = element_text(size = 12),
strip.text = element_text(size = 14, face = "italic"),
strip.text.y = element_text(angle = 180, hjust = 1, vjust = 0.5))
rawData <- read.csv("SpeedDatingData.csv", comment.char = "#", na.strings = "..")
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RAnalysis2")
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RAnalysis2/Cross-reviewing")
rawData <- read.csv("SpeedDatingData.csv", comment.char = "#", na.strings = "..")
library(dplyr)
data <- na.omit(rawData %>%
filter(gender == 0) %>%
select(attr_o, intel_o)) %>%
rename(attractivness = attr_o) %>%
rename(intelligence = intel_o)
library(ggplot2)
ggplot(data = data, aes(attractivness, intelligence))+
geom_jitter()+
scale_x_discrete(limits = 0:10)+
scale_y_discrete(limits = 0:10)+
ggtitle("Figure 1. Relation between female attractivness and intelligence")+
theme(plot.title = element_text(hjust = 0.5, size=11))
correlation <- cor.test(data$attractivness, data$intelligence)
correlationCoefficient <- correlation$estimate
p.value <- correlation$p.value
firstGroup <- data %>%
filter(attractivness %in% 0:5) %>%
mutate(group = as.factor(1))
secondGroup <- data %>%
filter(attractivness %in% 8:10) %>%
mutate(group = as.factor(2))
bothGroups <- rbind(firstGroup, secondGroup)
boxplot <- ggplot(bothGroups, aes(group, intelligence))+
geom_boxplot()+
ggtitle("Figure 2. Comparison of female intelligence in two groups")+
theme(plot.title = element_text(hjust = 0.5, size=11))
ggplot(bothGroups, aes(group, intelligence))+
geom_boxplot()+
ggtitle("Figure 2. Comparison of female intelligence in two groups")+
theme(plot.title = element_text(hjust = 0.5, size=11))
statistic <- t.test(firstGroup$intelligence, secondGroup$intelligence, alternative = "less")
means <- statistic$estimate
firstGroupMeanIntel <- means[["mean of x"]]
secondGroupMeanIntel <- means[["mean of y"]]
statistic.pvalue <- statistic$p.value
knitr::opts_chunk$set(echo = TRUE,fig.width = 12, fig.height = 6,
message = FALSE, warning = FALSE)
options(digits=2)
library(data.table)
data <- fread("USCS_cancer_1999_2013.csv")
library(dplyr)
brain_cancer <- data %>%
filter(SITE == "Brain and Other Nervous System") %>%
filter(EVENT_TYPE == "Incidence") %>%
filter(SEX %in% c("Female", "Male")) %>%
filter(RACE == "All Races") %>%
filter(YEAR != "2009-2013") %>%
filter(!(AREA %in% c("East North Central", "East South Central", "Middle Atlantic",
"Midwest", "Northeast", "Pacific", "South", "South Atlantic", "West",
"West North Central", "West South Central"))) %>%
select(AREA, COUNT, SEX, YEAR)
library(ggplot2)
library(RColorBrewer)
my_pal <- colorRampPalette(brewer.pal(6, "RdBu"))
by_area <- brain_cancer %>%
group_by(YEAR, AREA) %>%
summarise(count_by_area = sum(as.numeric(COUNT), na.rm = TRUE))
ggplot(by_area, aes(factor(AREA), as.numeric(count_by_area), fill=factor(YEAR))) +
geom_bar(stat = "identity") +
theme_bw() +
scale_x_discrete(name = "регион") +
scale_y_continuous(name = "количество случаев") +
scale_fill_manual(name = "год", values = my_pal(15)) +
ggtitle(label = "Количество случаев рака мозга в США в зависимости от штата") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(reshape2)
brain_cancer_cnt <- as.data.frame(t(dcast(brain_cancer, SEX ~ AREA + YEAR, value.var = "COUNT")))
colnames(brain_cancer_cnt) <- unname(unlist(brain_cancer_cnt[1, ]))
brain_cancer_cnt <- brain_cancer_cnt[-1, ]
brain_cancer_cnt <- brain_cancer_cnt[complete.cases(brain_cancer_cnt), ]
brain_cancer_cnt$year <- sapply(strsplit(rownames(brain_cancer_cnt), "_"), "[[", 2)
summarized_by_year <- brain_cancer_cnt %>%
group_by(year) %>%
summarise(total_count_male = sum(as.numeric(Male)), total_count_female = sum(as.numeric(Female)))
summarized_by_year_melted <- melt(summarized_by_year, id.var='year')
ggplot(summarized_by_year_melted, aes(year, value)) +
geom_bar(stat = "identity") +
theme_bw() +
scale_x_discrete(name = "год") +
scale_y_continuous(name = "количество случаев") +
ggtitle(label = "Количество случаев рака мозга в США по годам")
ggplot(summarized_by_year_melted, aes(year, value, fill=factor(variable))) +
geom_bar(stat = "identity", position = "dodge", alpha=0.5) +
theme_bw() +
scale_fill_manual(labels=c("Мужчины", "Женщины"), name="Кол-во случаев",
values = c("blue", 'red')) +
scale_x_discrete(name = "год") +
scale_y_continuous(name = "количество случаев") +
ggtitle(label = "Количество случаев рака мозга в зависимости от пола")
tt <- t.test(summarized_by_year$total_count_male, summarized_by_year$total_count_female,
paired = TRUE, conf.level = 0.99)
tt
